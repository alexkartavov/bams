<div class="grid-container">
  <igx-grid #ticketsGrid [data]="dataSource.connect() | async" [primaryKey]="'id'" height="500px" width="100%"
      [paging]="true" [paginationTemplate]="pagerTemplate" [perPage]="perPage" [emptyGridMessage]="' '"
      [displayDensity]="'cosy'" [rowSelectable]="false" (onSelection)="handleRowSelection($event)">
    <igx-column field="merchant" header="DBA Name" [dataType]="'string'" width="180px">
      <ng-template igxCell let-value>
        {{ value?.dbaName }}
      </ng-template>
    </igx-column>
    <igx-column field="merchant" header="Merchant Name" [dataType]="'string'" width="150px">
      <ng-template igxCell let-value>
        {{ value?.firstName }} {{ value?.lastName }}
      </ng-template>
    </igx-column>
    <igx-column field="merchant" header="Phone Number" [dataType]="'string'" width="130px">
      <ng-template igxCell let-value>
        {{ value?.phoneNumber }}
      </ng-template>
    </igx-column>
    <igx-column field="merchant" header="Email Address" [dataType]="'string'" width="150px">
      <ng-template igxCell let-value>
        {{ value?.emailAddress }}
      </ng-template>
    </igx-column>
    <igx-column field="mid" header="MID Number" [dataType]="'number'" width="100px"></igx-column>
    <igx-column field="desc" header="Updates Needed" [dataType]="'string'"></igx-column>
    <igx-column field="id" header="Ticket Number" [dataType]="'number'" width="100px"></igx-column>
    <igx-column field="type" header="Ticket Type" [dataType]="'string'" width="130px">
      <ng-template igxCell let-value>
        {{ ticketTypeTitle(value) }}
      </ng-template>
    </igx-column>
    <igx-column field="priority" header="Priority" [dataType]="'string'" width="100px">
      <ng-template igxCell let-value>
        {{ ticketPriorityTitle(value) }}
      </ng-template>
    </igx-column>
    <igx-column field="createdDate" header="Created On" [dataType]="'string'" width="100px">
        <ng-template igxCell let-value>
          {{ getDateString(value) }}
        </ng-template>
    </igx-column>
    <igx-column field="status" header="Ticket Status" [dataType]="'string'" width="130px">
      <ng-template igxCell let-value>
        {{ ticketStatusTitle(value) }}
      </ng-template>
    </igx-column>
    <igx-column field="assignedTo" header="Rep Assigned" [dataType]="'string'" width="120px"></igx-column>
  </igx-grid>
</div>

<div *ngIf="dataSource.loading$ | async" style="position:absolute;margin-top:-300px;margin-left:45%;">
  <div class="spinner-border text-primary" role="status">
    <span class="sr-only">Loading...</span>
  </div>
</div>

<ng-template #pagerTemplate>
  <div *ngIf="totalCount > 0" class="row" style="width:100%;">
    <div class="col-auto pt-1">Showing {{(page - 1) * perPage + 1}} - {{(page * perPage) > totalCount ? totalCount : page * perPage}} of {{totalCount}} results</div>
    <div class="col-auto pt-1">
      Show
      <select #selectPerPage (change)="perPage = selectPerPage.value">
        <option>5</option>
        <option selected>10</option>
        <option>25</option>
        <option>50</option>
        <option>100</option>
      </select>
      results
    </div>
    <div class="col">
      <pagination class="pull-right" [totalItems]="totalCount" [itemsPerPage]="perPage" [(ngModel)]="page" [previousText]="'&lt; Previous'" [nextText]="'Next &gt;'" (pageChanged)="pageChanged($event)"></pagination>
    </div>
  </div>
</ng-template>
